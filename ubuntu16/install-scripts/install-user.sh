#!/bin/sh
# dpw@iMac.localdomain
# 2018.07.21
#

set -eu

if [ -d /home/vagrant ]
then
    echo "running as `whoami`"
else
    echo "no user yet, try again later..."
    exit 0
fi

TARGET=/home/vagrant/.ssh/id_rsa

if [ -f $TARGET ]
then
    echo "in place, nothing to do..."
    exit 0
fi

blob='LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb1FJQkFBS0NBUUVBK0s3TVQwZ3AvVm5YZitSYTlObFhyNi9qN2F1b29pQU1XdHRyZWI1UXNnd2E4aU13CnFCa0NQSmdQYURQdXFqbFlRQkIycmNTZmJteDVjSEw4QlQraWJFRCt2SFFxU250Zko0UUVnWS9lS1pHbU1vZU8KL2VKUWdmVmFSQTRNMzRpU0k2TURrbzIzVllldGRYazNMNGlSbE9PbSsrR2R4eVBpTGZmM0EyNEI5K0I1UDZmVgpUNGFoWjJ0d2pIaEhmSG85MFY0WFBRWVFWNkFSenZrWmNhcnVZV1AyRFJ0NGxSWEdHSEpVVC8yNjVscDk2U0IrCjhEM1NRcEQvdEs3ZVVNUFlRQWZnbis1UWhPVy9FcGNBR0lkL1NBWThXV2lrWnlWZ0g3OWlEd2xDYmJBdit3STcKMGhOdjdmSkFMcVIzYjVrVmNMbGpsL3VBRDZuanNuYUEwNWk0M1FJQkl3S0NBUUI0eWU0MUl3MFVwL3IwK2VNSgpObDNLWEw4cVRCQVVPM08zR2g1Q2NtRzFrTm5qVXV1L1hKcXZ0NUowY1A3azkwZ2ZIZkNBU1k5RVExRHRlYTJjCkpqanl3SHU2bnRLMmRuQUw0UW1Bd2ppMUd0dXlKSlhwQjRZd2ZueE04T0d1WnVmbGJHOXpFYUl3MjRBakhaNTIKTEdQMzNFbkt6S3U0ZnlTM1BlMEJxblg4RFB5ajYrQ3YvWjlCWldVMWwwNXZ0bkk5Qmo2SWJicURiYUo2enNvVwp2djM2c2xhYTdCYVg1Tis3WEROak5ubXU2Tlc2M3pYZXFESzRyMy9ERjBJUVhHVlNYSnhNaXpRbmJDWlBvTXRrCmxncU5aL0FPcmxRQmZOZ2NlcFI4a24wUXRIeDVNbHVlb1BHRS9CVk5JWmZneERrUEhYUjhuWVlvWUNpaFFNTFYKdHkzZkFvR0JBUDJZdUdVMXdPM3lLY1lNVmZDSFMveGJCaGVwcGpUclV5TXBlZHFnRmpad2JFYVVtdTJnRlZwLwpxWkJPSVI0TDRDTHY5eXVOWG1sZjVUbVRuVGxCN1doT1FNQ0ZSTG1MU2RXa2cxQXZyajZMZEc2aHRmOHlOdFpaCllYK1Y5SWRiQ0tSSHh6SFBiMFA4bldOdCt1M1Fna1c5Y3BkVG9VOTk2V0F3Qit1UXoyMGpBb0dCQVBzS0orek4Kamx5Rk5LenpycGRhZW1WVER1ZytRYlhISCt0c2JCYzVWc3NwRUF3NWkydUFDeGR4WlVzbWlwTkZNWlBoMWo3VQpza3ZBeWZ0VExRMzhObFFMK1dYWGJPQk9GNXFONXNIZGhqb1I2UDJaZU9reDNuSjhyTTdpQlVFZGNERVVENWlzCi9uYnVtU2xlR1JTeU40ZG0reGl0TS80K29DL2NGbTJLeUtIL0FvR0FleXpyMldOQWM1TGhGdzFPVUVHM01XNEsKUmdIeHBLelFuQXpVeVVaeE1HSjl1K0hIbC8xTU0wVlNYQWl3Ly9janVUSzU0ZlExSzk0ZTRYT1ZnalgyK0NZQwpNWi9RN0dnNXppdFZ1VHU3Q0crZTgrZ2xNczgvTk9tVndhQ2JWNi9mb0VBZTdFN1BwSzNtQzdrVGV0TDljbFMwCkFGdlNBZ24xQXRXQU1KYkxKbUVDZ1lFQTg5MzY1Z21DK3NxSzhTYzc0M3gyNWhZcnZRbEhKWnpkTGRjSjZxeTYKdHJvczJLenQxaVNkRDNWNFY2SEljYzR3S1VISXoxSkd6VDd3R0xjekZPWmdxV3Ezd2dSNFpONGxqdEw5YTk2QwpaRXZwcGVXTFpqQnhzUXRtQ3N6dktVL01FbXRDV2N5ZmJEZzlBNTA4NzRpTnRydlBXY3pUYkFKU2Q2S1pjYm9FCnVwOENnWUFQSWYxaWlSNDk1QlFZdzJid3o1SzVlMmlkUlViclRjWWQ2NzRrdjV3NUN4b3ZoK0ZKbk1mdmRGTUUKTkZjZkttaDF2SGxQVHRCUDJPYkorMXVXL2dWT1YzSmlNL1o2UEx1WHZCWnJlU252WWZOL1g2b0l6L2Vod211YQoxWDR4UkYzM3RvQks0cXJUQnd1ckk2YXlaUzBhWWdqQmZubEtMcFQwUkxLSlFLSkY1dz09Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg=='

echo $blob | base64 --decode > $TARGET

chmod 400 $TARGET
chown vagrant:vagrant $TARGET

chown -R vagrant:vagrant /home/vagrant/

exit 0
